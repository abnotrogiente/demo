import"./modulepreload-polyfill-B5Qt9EMX.js";import{P as C,V as d,C as r,S as f,M as v,a as F,D as P,b as D,c as I,d as b,A as E,e as z,W as G,O as H,f as B}from"./OrbitControls-DkK6GvWB.js";import{g as L}from"./lil-gui.module.min-Vka56b52.js";const p=300,w=300;class V{constructor(t,e,n,a,s){console.log("enter ground constructor"),this.gui=a,this.camera=e,this.width_px=Math.round(p/n),this.height_px=Math.round(w/n);const o=new C(p,w,this.width_px,this.height_px);o.rotateX(-Math.PI/2),this.sunAngleWrapper=s;const m=this.sunAngleWrapper.angle,g=new d(Math.cos(m),-Math.sin(m),0);g.normalize();const x=.4;this.omega=2*Math.PI*x,this.amplitude=1,this.order=100,this.frequencyVariation=0,this.pulsationFactor=1.18,this.amplitudeFactor=.82,this.lambda0=50,this.amplitude0=1.5,this.initializeWaveParameters(this.order);const A={deepColor:{value:new r(3506363)},shallowColor:{value:new r(2250239)},lightDirection:{type:"v3",value:g},lightColor:{value:new r(16777045)},viewPos:{type:"v3",value:e.position},shininess:{value:300},k_array:{value:this.k_array},frag_k_array:{value:this.k_array},omega_array:{value:this.omega_array},frag_omega_array:{value:this.omega_array},amplitude_factor:{value:this.amplitudeFactor},frag_amplitude_factor:{value:this.amplitudeFactor},t:{value:0},amplitude:{value:this.amplitude0},frag_amplitude:{value:this.amplitude0}},_=document.getElementById("vertexShader").textContent,k=document.getElementById("fragmentShader").textContent,W=new f({uniforms:A,vertexShader:_,fragmentShader:k});this.plane=new v(o,W),t.add(this.plane),this.setupGui()}setupGui(){this.gui.addFolder("sun").add(this.sunAngleWrapper,"angle",0,Math.PI).name("angle"),this.gui.addFolder("water").add(this.plane.material.uniforms.shininess,"value",10,500,1).name("shininess")}initializeWaveParameters(t){this.k_array=[],this.omega_array=[];for(let e=0;e<t;e++){const n=this.lambda0*Math.pow(this.pulsationFactor,-e),a=2*Math.PI/n,s=new F(Math.random(),Math.random());s.normalize(),s.multiplyScalar(a),this.k_array.push(s),(2*Math.random()-1)*this.frequencyVariation;const o=this.omega*Math.pow(this.pulsationFactor,.5*e);this.omega_array.push(o)}}update(t){this.plane.material.uniforms.t.value=t,this.plane.material.uniforms.viewPos.value=this.camera.position;const e=this.sunAngleWrapper.angle,n=Math.sin(e),a=new d(Math.cos(e),-n,0);this.plane.material.uniforms.lightDirection.value=a,this.sunAngleWrapper.color=new r().setFromVector3(new d(1,1,n+.1)),this.plane.material.uniforms.lightColor.value=this.sunAngleWrapper.color}}class T{constructor(t,e,n,a,s){this.sunAngleWrapper=s,this.gui=a,this.camera=n,console.log("enter sky constructore"),this.initMaterial(),this.material.side=P,this.mesh=new v(new D(e),this.material);const o=this.gui.addFolder("sky");t.add(this.mesh),o.add(this.mesh.material.uniforms.shininess,"value",1,500,1).name("sun shininess"),console.log("sky added")}initMaterial(){const t=this.sunAngleWrapper.angle,e=Math.sin(t),n=new d(Math.cos(t),-e,0);this.shininess=200;const a={sunColor:{value:new r(16777088)},skyColor:{value:new r(52479)},shininess:{value:this.shininess},sunDirection:{value:n},viewPos:{value:this.camera.position}},s=document.getElementById("vertexShaderSky").textContent,o=document.getElementById("fragmentShaderSky").textContent;this.material=new f({uniforms:a,vertexShader:s,fragmentShader:o})}update(){const t=this.sunAngleWrapper.angle,e=Math.sin(t),n=new d(Math.cos(t),-e,0);this.mesh.material.uniforms.sunDirection.value=n,this.mesh.material.uniforms.sunColor.value=this.sunAngleWrapper.color}}let h=null,i=null,l=null,c=null,y=null,M=null;const q=()=>{h=new I;const u=window.innerWidth/window.innerHeight;i=new b(75,u,.1,1e3);const t=new E(16777215,.6);h.add(t);const e=new z(16777215,.8);h.add(e),l=new G,l.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(l.domElement),new H(i,l.domElement).listenToKeyEvents(window),i.position.x=100,i.position.y=20,i.lookAt(0,0,0);const a={angle:Math.PI/7,color:new r},s=new L;c=new B,y=new V(h,i,.5,s,a),console.log("before sky"),M=new T(h,500,i,s,a),console.log("after sky")},S=()=>{l.setAnimationLoop(S),c.getDelta();const u=c.getElapsedTime();y.update(u),M.update(),l.render(h,i)};q();S();window.addEventListener("resize",O,!1);function O(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),l.setSize(window.innerWidth,window.innerHeight)}
//# sourceMappingURL=demo1-AgiLnLly.js.map
