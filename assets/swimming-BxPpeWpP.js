import"./modulepreload-polyfill-B5Qt9EMX.js";function J(i){const g=Q(i),d=tt(i),w=Z(i),A=et(i);return{position:g,normal:A,textureCoord:d,indices:w}}function Q(i){const g=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,g);const d=[-1,-1,1,1,-1,1,1,1,1,-1,1,1];return i.bufferData(i.ARRAY_BUFFER,new Float32Array(d),i.STATIC_DRAW),g}function Z(i){const g=i.createBuffer();i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,g);const d=[0,1,2,0,2,3];return i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),i.STATIC_DRAW),g}function tt(i){const g=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,g);const d=[0,0,1,0,1,1,0,1];return i.bufferData(i.ARRAY_BUFFER,new Float32Array(d),i.STATIC_DRAW),g}function et(i){const g=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,g);const d=[0,0,1,0,0,1,0,0,1,0,0,1];return i.bufferData(i.ARRAY_BUFFER,new Float32Array(d),i.STATIC_DRAW),g}function rt(i,g,d,w,A){i.clearColor(0,0,0,1),i.clearDepth(1),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);const p=45*Math.PI/180,T=i.canvas.clientWidth/i.canvas.clientHeight,F=.1,D=100,B=mat4.create();mat4.perspective(B,p,T,F,D);const b=mat4.create();mat4.translate(b,b,[-0,0,-6]),mat4.rotate(b,b,A,[0,0,1]),mat4.rotate(b,b,A*.7,[0,1,0]),mat4.rotate(b,b,A*.3,[1,0,0]);const v=mat4.create();mat4.invert(v,b),mat4.transpose(v,v),it(i,d,g),nt(i,d,g),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,d.indices),at(i,d,g),i.useProgram(g.program),i.uniformMatrix4fv(g.uniformLocations.projectionMatrix,!1,B),i.uniformMatrix4fv(g.uniformLocations.modelViewMatrix,!1,b),i.uniformMatrix4fv(g.uniformLocations.normalMatrix,!1,v),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,w),i.uniform1i(g.uniformLocations.uSampler,0);{const S=i.UNSIGNED_SHORT;i.drawElements(i.TRIANGLES,6,S,0)}}function it(i,g,d){const A=i.FLOAT,p=!1,T=0,F=0;i.bindBuffer(i.ARRAY_BUFFER,g.position),i.vertexAttribPointer(d.attribLocations.vertexPosition,3,A,p,T,F),i.enableVertexAttribArray(d.attribLocations.vertexPosition)}function nt(i,g,d){const A=i.FLOAT,p=!1,T=0,F=0;i.bindBuffer(i.ARRAY_BUFFER,g.textureCoord),i.vertexAttribPointer(d.attribLocations.textureCoord,2,A,p,T,F),i.enableVertexAttribArray(d.attribLocations.textureCoord)}function at(i,g,d){const A=i.FLOAT,p=!1,T=0,F=0;i.bindBuffer(i.ARRAY_BUFFER,g.normal),i.vertexAttribPointer(d.attribLocations.vertexNormal,3,A,p,T,F),i.enableVertexAttribArray(d.attribLocations.vertexNormal)}var ot=function(){var i,g={create:function(e){e=e||{};var r=document.createElement("canvas");r.width=800,r.height=600,"alpha"in e||(e.alpha=!1);try{i=r.getContext("webgl",e)}catch{}try{i=i||r.getContext("experimental-webgl",e)}catch{}if(!i)throw new Error("WebGL not supported");return i.HALF_FLOAT_OES=36193,d(),w(),A(),D(),i},keys:{},Matrix:v,Indexer:C,Buffer:S,Mesh:P,HitTest:I,Raytracer:N,Shader:k,Texture:_,Vector:h};function d(){i.MODELVIEW=B|1,i.PROJECTION=B|2;var e=new v,r=new v;i.modelviewMatrix=new v,i.projectionMatrix=new v;var t=[],n=[],a,o;i.matrixMode=function(u){switch(u){case i.MODELVIEW:a="modelviewMatrix",o=t;break;case i.PROJECTION:a="projectionMatrix",o=n;break;default:throw new Error("invalid matrix mode "+u)}},i.loadIdentity=function(){v.identity(i[a])},i.loadMatrix=function(u){for(var s=u.m,m=i[a].m,c=0;c<16;c++)m[c]=s[c]},i.multMatrix=function(u){i.loadMatrix(v.multiply(i[a],u,r))},i.perspective=function(u,s,m,c){i.multMatrix(v.perspective(u,s,m,c,e))},i.frustum=function(u,s,m,c,f,l){i.multMatrix(v.frustum(u,s,m,c,f,l,e))},i.ortho=function(u,s,m,c,f,l){i.multMatrix(v.ortho(u,s,m,c,f,l,e))},i.scale=function(u,s,m){i.multMatrix(v.scale(u,s,m,e))},i.translate=function(u,s,m){i.multMatrix(v.translate(u,s,m,e))},i.rotate=function(u,s,m,c){i.multMatrix(v.rotate(u,s,m,c,e))},i.lookAt=function(u,s,m,c,f,l,E,x,y){i.multMatrix(v.lookAt(u,s,m,c,f,l,E,x,y,e))},i.pushMatrix=function(){o.push(Array.prototype.slice.call(i[a].m))},i.popMatrix=function(){var u=o.pop();i[a].m=b?new Float32Array(u):u},i.project=function(u,s,m,c,f,l){c=c||i.modelviewMatrix,f=f||i.projectionMatrix,l=l||i.getParameter(i.VIEWPORT);var E=f.transformPoint(c.transformPoint(new h(u,s,m)));return new h(l[0]+l[2]*(E.x*.5+.5),l[1]+l[3]*(E.y*.5+.5),E.z*.5+.5)},i.unProject=function(u,s,m,c,f,l){c=c||i.modelviewMatrix,f=f||i.projectionMatrix,l=l||i.getParameter(i.VIEWPORT);var E=new h((u-l[0])/l[2]*2-1,(s-l[1])/l[3]*2-1,m*2-1);return v.inverse(v.multiply(f,c,e),r).transformPoint(E)},i.matrixMode(i.MODELVIEW)}function w(){var e={mesh:new P({coords:!0,colors:!0,triangles:!1}),mode:-1,coord:[0,0,0,0],color:[1,1,1,1],shader:new k("      uniform float pointSize;      varying vec4 color;      varying vec4 coord;      void main() {        color = gl_Color;        coord = gl_TexCoord;        gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;        gl_PointSize = pointSize;      }    ","      uniform sampler2D texture;      uniform float pointSize;      uniform bool useTexture;      varying vec4 color;      varying vec4 coord;      void main() {        gl_FragColor = color;        if (useTexture) gl_FragColor *= texture2D(texture, coord.xy);      }    ")};i.pointSize=function(r){e.shader.uniforms({pointSize:r})},i.begin=function(r){if(e.mode!=-1)throw new Error("mismatched gl.begin() and gl.end() calls");e.mode=r,e.mesh.colors=[],e.mesh.coords=[],e.mesh.vertices=[]},i.color=function(r,t,n,a){e.color=arguments.length==1?r.toArray().concat(1):[r,t,n,a||1]},i.texCoord=function(r,t){e.coord=arguments.length==1?r.toArray(2):[r,t]},i.vertex=function(r,t,n){e.mesh.colors.push(e.color),e.mesh.coords.push(e.coord),e.mesh.vertices.push(arguments.length==1?r.toArray():[r,t,n])},i.end=function(){if(e.mode==-1)throw new Error("mismatched gl.begin() and gl.end() calls");e.mesh.compile(),e.shader.uniforms({useTexture:!!i.getParameter(i.TEXTURE_BINDING_2D)}).draw(e.mesh,e.mode),e.mode=-1}}function A(){var e=i,r=0,t=0,n={},a=!1,o=Object.prototype.hasOwnProperty;function u(){for(var x in n)if(o.call(n,x)&&n[x])return!0;return!1}function s(x){var y={};for(var R in x)typeof x[R]=="function"?y[R]=function(U){return function(){U.apply(x,arguments)}}(x[R]):y[R]=x[R];y.original=x,y.x=y.pageX,y.y=y.pageY;for(var M=i.canvas;M;M=M.offsetParent)y.x-=M.offsetLeft,y.y-=M.offsetTop;return a?(y.deltaX=y.x-r,y.deltaY=y.y-t):(y.deltaX=0,y.deltaY=0,a=!0),r=y.x,t=y.y,y.dragging=u(),y.preventDefault=function(){y.original.preventDefault()},y.stopPropagation=function(){y.original.stopPropagation()},y}function m(x){i=e,u()||(T(document,"mousemove",c),T(document,"mouseup",f),F(i.canvas,"mousemove",c),F(i.canvas,"mouseup",f)),n[x.which]=!0,x=s(x),i.onmousedown&&i.onmousedown(x),x.preventDefault()}function c(x){i=e,x=s(x),i.onmousemove&&i.onmousemove(x),x.preventDefault()}function f(x){i=e,n[x.which]=!1,u()||(F(document,"mousemove",c),F(document,"mouseup",f),T(i.canvas,"mousemove",c),T(i.canvas,"mouseup",f)),x=s(x),i.onmouseup&&i.onmouseup(x),x.preventDefault()}function l(){a=!1}function E(){n={},a=!1}T(i.canvas,"mousedown",m),T(i.canvas,"mousemove",c),T(i.canvas,"mouseup",f),T(i.canvas,"mouseover",l),T(i.canvas,"mouseout",l),T(document,"contextmenu",E)}function p(e){var r={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"};return r[e]||(e>=65&&e<=90?String.fromCharCode(e):null)}function T(e,r,t){e.addEventListener(r,t)}function F(e,r,t){e.removeEventListener(r,t)}T(document,"keydown",function(e){if(!e.altKey&&!e.ctrlKey&&!e.metaKey){var r=p(e.keyCode);r&&(g.keys[r]=!0),g.keys[e.keyCode]=!0}}),T(document,"keyup",function(e){if(!e.altKey&&!e.ctrlKey&&!e.metaKey){var r=p(e.keyCode);r&&(g.keys[r]=!1),g.keys[e.keyCode]=!1}});function D(){(function(e){i.makeCurrent=function(){i=e}})(i),i.animate=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(a){setTimeout(a,16.666666666666668)},r=new Date().getTime(),t=i;function n(){i=t;var a=new Date().getTime();i.onupdate&&i.onupdate((a-r)/1e3),i.ondraw&&i.ondraw(),e(n),r=a}n()},i.fullscreen=function(e){e=e||{};var r=e.paddingTop||0,t=e.paddingLeft||0,n=e.paddingRight||0,a=e.paddingBottom||0;if(!document.body)throw new Error("document.body doesn't exist yet (call gl.fullscreen() from window.onload() or from inside the <body> tag)");document.body.appendChild(i.canvas),document.body.style.overflow="hidden",i.canvas.style.position="absolute",i.canvas.style.left=t+"px",i.canvas.style.top=r+"px";function o(){i.canvas.width=window.innerWidth-t-n,i.canvas.height=window.innerHeight-r-a,i.viewport(0,0,i.canvas.width,i.canvas.height),(e.camera||!("camera"in e))&&(i.matrixMode(i.PROJECTION),i.loadIdentity(),i.perspective(e.fov||45,i.canvas.width/i.canvas.height,e.near||.1,e.far||1e3),i.matrixMode(i.MODELVIEW)),i.ondraw&&i.ondraw()}T(window,"resize",o),o()}}var B=305397760,b=typeof Float32Array<"u";function v(){var e=Array.prototype.concat.apply([],arguments);e.length||(e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.m=b?new Float32Array(e):e}v.prototype={inverse:function(){return v.inverse(this,new v)},transpose:function(){return v.transpose(this,new v)},multiply:function(e){return v.multiply(this,e,new v)},transformPoint:function(e){var r=this.m;return new h(r[0]*e.x+r[1]*e.y+r[2]*e.z+r[3],r[4]*e.x+r[5]*e.y+r[6]*e.z+r[7],r[8]*e.x+r[9]*e.y+r[10]*e.z+r[11]).divide(r[12]*e.x+r[13]*e.y+r[14]*e.z+r[15])},transformVector:function(e){var r=this.m;return new h(r[0]*e.x+r[1]*e.y+r[2]*e.z,r[4]*e.x+r[5]*e.y+r[6]*e.z,r[8]*e.x+r[9]*e.y+r[10]*e.z)}},v.inverse=function(e,r){r=r||new v;var t=e.m,n=r.m;n[0]=t[5]*t[10]*t[15]-t[5]*t[14]*t[11]-t[6]*t[9]*t[15]+t[6]*t[13]*t[11]+t[7]*t[9]*t[14]-t[7]*t[13]*t[10],n[1]=-t[1]*t[10]*t[15]+t[1]*t[14]*t[11]+t[2]*t[9]*t[15]-t[2]*t[13]*t[11]-t[3]*t[9]*t[14]+t[3]*t[13]*t[10],n[2]=t[1]*t[6]*t[15]-t[1]*t[14]*t[7]-t[2]*t[5]*t[15]+t[2]*t[13]*t[7]+t[3]*t[5]*t[14]-t[3]*t[13]*t[6],n[3]=-t[1]*t[6]*t[11]+t[1]*t[10]*t[7]+t[2]*t[5]*t[11]-t[2]*t[9]*t[7]-t[3]*t[5]*t[10]+t[3]*t[9]*t[6],n[4]=-t[4]*t[10]*t[15]+t[4]*t[14]*t[11]+t[6]*t[8]*t[15]-t[6]*t[12]*t[11]-t[7]*t[8]*t[14]+t[7]*t[12]*t[10],n[5]=t[0]*t[10]*t[15]-t[0]*t[14]*t[11]-t[2]*t[8]*t[15]+t[2]*t[12]*t[11]+t[3]*t[8]*t[14]-t[3]*t[12]*t[10],n[6]=-t[0]*t[6]*t[15]+t[0]*t[14]*t[7]+t[2]*t[4]*t[15]-t[2]*t[12]*t[7]-t[3]*t[4]*t[14]+t[3]*t[12]*t[6],n[7]=t[0]*t[6]*t[11]-t[0]*t[10]*t[7]-t[2]*t[4]*t[11]+t[2]*t[8]*t[7]+t[3]*t[4]*t[10]-t[3]*t[8]*t[6],n[8]=t[4]*t[9]*t[15]-t[4]*t[13]*t[11]-t[5]*t[8]*t[15]+t[5]*t[12]*t[11]+t[7]*t[8]*t[13]-t[7]*t[12]*t[9],n[9]=-t[0]*t[9]*t[15]+t[0]*t[13]*t[11]+t[1]*t[8]*t[15]-t[1]*t[12]*t[11]-t[3]*t[8]*t[13]+t[3]*t[12]*t[9],n[10]=t[0]*t[5]*t[15]-t[0]*t[13]*t[7]-t[1]*t[4]*t[15]+t[1]*t[12]*t[7]+t[3]*t[4]*t[13]-t[3]*t[12]*t[5],n[11]=-t[0]*t[5]*t[11]+t[0]*t[9]*t[7]+t[1]*t[4]*t[11]-t[1]*t[8]*t[7]-t[3]*t[4]*t[9]+t[3]*t[8]*t[5],n[12]=-t[4]*t[9]*t[14]+t[4]*t[13]*t[10]+t[5]*t[8]*t[14]-t[5]*t[12]*t[10]-t[6]*t[8]*t[13]+t[6]*t[12]*t[9],n[13]=t[0]*t[9]*t[14]-t[0]*t[13]*t[10]-t[1]*t[8]*t[14]+t[1]*t[12]*t[10]+t[2]*t[8]*t[13]-t[2]*t[12]*t[9],n[14]=-t[0]*t[5]*t[14]+t[0]*t[13]*t[6]+t[1]*t[4]*t[14]-t[1]*t[12]*t[6]-t[2]*t[4]*t[13]+t[2]*t[12]*t[5],n[15]=t[0]*t[5]*t[10]-t[0]*t[9]*t[6]-t[1]*t[4]*t[10]+t[1]*t[8]*t[6]+t[2]*t[4]*t[9]-t[2]*t[8]*t[5];for(var a=t[0]*n[0]+t[1]*n[4]+t[2]*n[8]+t[3]*n[12],o=0;o<16;o++)n[o]/=a;return r},v.transpose=function(e,r){r=r||new v;var t=e.m,n=r.m;return n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15],r},v.multiply=function(e,r,t){t=t||new v;var n=e.m,a=r.m,o=t.m;return o[0]=n[0]*a[0]+n[1]*a[4]+n[2]*a[8]+n[3]*a[12],o[1]=n[0]*a[1]+n[1]*a[5]+n[2]*a[9]+n[3]*a[13],o[2]=n[0]*a[2]+n[1]*a[6]+n[2]*a[10]+n[3]*a[14],o[3]=n[0]*a[3]+n[1]*a[7]+n[2]*a[11]+n[3]*a[15],o[4]=n[4]*a[0]+n[5]*a[4]+n[6]*a[8]+n[7]*a[12],o[5]=n[4]*a[1]+n[5]*a[5]+n[6]*a[9]+n[7]*a[13],o[6]=n[4]*a[2]+n[5]*a[6]+n[6]*a[10]+n[7]*a[14],o[7]=n[4]*a[3]+n[5]*a[7]+n[6]*a[11]+n[7]*a[15],o[8]=n[8]*a[0]+n[9]*a[4]+n[10]*a[8]+n[11]*a[12],o[9]=n[8]*a[1]+n[9]*a[5]+n[10]*a[9]+n[11]*a[13],o[10]=n[8]*a[2]+n[9]*a[6]+n[10]*a[10]+n[11]*a[14],o[11]=n[8]*a[3]+n[9]*a[7]+n[10]*a[11]+n[11]*a[15],o[12]=n[12]*a[0]+n[13]*a[4]+n[14]*a[8]+n[15]*a[12],o[13]=n[12]*a[1]+n[13]*a[5]+n[14]*a[9]+n[15]*a[13],o[14]=n[12]*a[2]+n[13]*a[6]+n[14]*a[10]+n[15]*a[14],o[15]=n[12]*a[3]+n[13]*a[7]+n[14]*a[11]+n[15]*a[15],t},v.identity=function(e){e=e||new v;var r=e.m;return r[0]=r[5]=r[10]=r[15]=1,r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=r[12]=r[13]=r[14]=0,e},v.perspective=function(e,r,t,n,a){var o=Math.tan(e*Math.PI/360)*t,u=o*r;return v.frustum(-u,u,-o,o,t,n,a)},v.frustum=function(e,r,t,n,a,o,u){u=u||new v;var s=u.m;return s[0]=2*a/(r-e),s[1]=0,s[2]=(r+e)/(r-e),s[3]=0,s[4]=0,s[5]=2*a/(n-t),s[6]=(n+t)/(n-t),s[7]=0,s[8]=0,s[9]=0,s[10]=-(o+a)/(o-a),s[11]=-2*o*a/(o-a),s[12]=0,s[13]=0,s[14]=-1,s[15]=0,u},v.ortho=function(e,r,t,n,a,o,u){u=u||new v;var s=u.m;return s[0]=2/(r-e),s[1]=0,s[2]=0,s[3]=-(r+e)/(r-e),s[4]=0,s[5]=2/(n-t),s[6]=0,s[7]=-(n+t)/(n-t),s[8]=0,s[9]=0,s[10]=-2/(o-a),s[11]=-(o+a)/(o-a),s[12]=0,s[13]=0,s[14]=0,s[15]=1,u},v.scale=function(e,r,t,n){n=n||new v;var a=n.m;return a[0]=e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=r,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,n},v.translate=function(e,r,t,n){n=n||new v;var a=n.m;return a[0]=1,a[1]=0,a[2]=0,a[3]=e,a[4]=0,a[5]=1,a[6]=0,a[7]=r,a[8]=0,a[9]=0,a[10]=1,a[11]=t,a[12]=0,a[13]=0,a[14]=0,a[15]=1,n},v.rotate=function(e,r,t,n,a){if(!e||!r&&!t&&!n)return v.identity(a);a=a||new v;var o=a.m,u=Math.sqrt(r*r+t*t+n*n);e*=Math.PI/180,r/=u,t/=u,n/=u;var s=Math.cos(e),m=Math.sin(e),c=1-s;return o[0]=r*r*c+s,o[1]=r*t*c-n*m,o[2]=r*n*c+t*m,o[3]=0,o[4]=t*r*c+n*m,o[5]=t*t*c+s,o[6]=t*n*c-r*m,o[7]=0,o[8]=n*r*c-t*m,o[9]=n*t*c+r*m,o[10]=n*n*c+s,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,a},v.lookAt=function(e,r,t,n,a,o,u,s,m,c){c=c||new v;var f=c.m,l=new h(e,r,t),E=new h(n,a,o),x=new h(u,s,m),y=l.subtract(E).unit(),R=x.cross(y).unit(),M=y.cross(R).unit();return f[0]=R.x,f[1]=R.y,f[2]=R.z,f[3]=-R.dot(l),f[4]=M.x,f[5]=M.y,f[6]=M.z,f[7]=-M.dot(l),f[8]=y.x,f[9]=y.y,f[10]=y.z,f[11]=-y.dot(l),f[12]=0,f[13]=0,f[14]=0,f[15]=1,c};function C(){this.unique=[],this.indices=[],this.map={}}C.prototype={add:function(e){var r=JSON.stringify(e);return r in this.map||(this.map[r]=this.unique.length,this.unique.push(e)),this.map[r]}};function S(e,r){this.buffer=null,this.target=e,this.type=r,this.data=[]}S.prototype={compile:function(e){for(var r=[],t=0,n=1e4;t<this.data.length;t+=n)r=Array.prototype.concat.apply(r,this.data.slice(t,t+n));var a=this.data.length?r.length/this.data.length:0;if(a!=Math.round(a))throw new Error("buffer elements not of consistent size, average size is "+a);this.buffer=this.buffer||i.createBuffer(),this.buffer.length=r.length,this.buffer.spacing=a,i.bindBuffer(this.target,this.buffer),i.bufferData(this.target,new this.type(r),e||i.STATIC_DRAW)}};function P(e){e=e||{},this.vertexBuffers={},this.indexBuffers={},this.addVertexBuffer("vertices","gl_Vertex"),e.coords&&this.addVertexBuffer("coords","gl_TexCoord"),e.normals&&this.addVertexBuffer("normals","gl_Normal"),e.colors&&this.addVertexBuffer("colors","gl_Color"),(!("triangles"in e)||e.triangles)&&this.addIndexBuffer("triangles"),e.lines&&this.addIndexBuffer("lines")}P.prototype={addVertexBuffer:function(e,r){var t=this.vertexBuffers[r]=new S(i.ARRAY_BUFFER,Float32Array);t.name=e,this[e]=[]},addIndexBuffer:function(e){this.indexBuffers[e]=new S(i.ELEMENT_ARRAY_BUFFER,Uint16Array),this[e]=[]},compile:function(){for(var e in this.vertexBuffers){var r=this.vertexBuffers[e];r.data=this[r.name],r.compile()}for(var t in this.indexBuffers){var r=this.indexBuffers[t];r.data=this[t],r.compile()}},transform:function(e){if(this.vertices=this.vertices.map(function(t){return e.transformPoint(h.fromArray(t)).toArray()}),this.normals){var r=e.inverse().transpose();this.normals=this.normals.map(function(t){return r.transformVector(h.fromArray(t)).unit().toArray()})}return this.compile(),this},computeNormals:function(){this.normals||this.addVertexBuffer("normals","gl_Normal");for(var e=0;e<this.vertices.length;e++)this.normals[e]=new h;for(var e=0;e<this.triangles.length;e++){var r=this.triangles[e],t=h.fromArray(this.vertices[r[0]]),n=h.fromArray(this.vertices[r[1]]),a=h.fromArray(this.vertices[r[2]]),o=n.subtract(t).cross(a.subtract(t)).unit();this.normals[r[0]]=this.normals[r[0]].add(o),this.normals[r[1]]=this.normals[r[1]].add(o),this.normals[r[2]]=this.normals[r[2]].add(o)}for(var e=0;e<this.vertices.length;e++)this.normals[e]=this.normals[e].unit().toArray();return this.compile(),this},computeWireframe:function(){for(var e=new C,r=0;r<this.triangles.length;r++)for(var t=this.triangles[r],n=0;n<t.length;n++){var a=t[n],o=t[(n+1)%t.length];e.add([Math.min(a,o),Math.max(a,o)])}return this.lines||this.addIndexBuffer("lines"),this.lines=e.unique,this.compile(),this},getAABB:function(){var e={min:new h(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};e.max=e.min.negative();for(var r=0;r<this.vertices.length;r++){var t=h.fromArray(this.vertices[r]);e.min=h.min(e.min,t),e.max=h.max(e.max,t)}return e},getBoundingSphere:function(){for(var e=this.getAABB(),r={center:e.min.add(e.max).divide(2),radius:0},t=0;t<this.vertices.length;t++)r.radius=Math.max(r.radius,h.fromArray(this.vertices[t]).subtract(r.center).length());return r}},P.plane=function(e){e=e||{};for(var r=new P(e),t=e.detailX||e.detail||1,n=e.detailY||e.detail||1,a=e.width||2,o=e.height||2,u=0;u<=n;u++)for(var s=u/n,m=0;m<=t;m++){var c=m/t;if(r.vertices.push([(c-.5)*a,(s-.5)*o,0]),r.coords&&r.coords.push([c,s]),r.normals&&r.normals.push([0,0,1]),m<t&&u<n){var f=m+u*(t+1);r.triangles.push([f,f+1,f+t+1]),r.triangles.push([f+t+1,f+1,f+t+2])}}return r.compile(),r};var Y=[[0,4,2,6,-1,0,0],[1,3,5,7,1,0,0],[0,1,4,5,0,-1,0],[2,6,3,7,0,1,0],[0,2,1,3,0,0,-1],[4,5,6,7,0,0,1]];function H(e){return new h((e&1)*2-1,(e&2)-1,(e&4)/2-1)}P.cube=function(e){for(var r=new P(e),t=e&&e.width||2,n=e&&e.height||2,a=e&&e.depth||2,o=0;o<Y.length;o++){for(var u=Y[o],s=o*4,m=0;m<4;m++){var c=u[m];const f=H(c).toArray();f[0]*=t/2,f[1]*=n/2,f[2]*=a/2,r.vertices.push(f),r.coords&&r.coords.push([m&1,(m&2)/2]),r.normals&&r.normals.push(u.slice(4,7))}r.triangles.push([s,s+1,s+2]),r.triangles.push([s+2,s+1,s+3])}return r.compile(),r},P.sphere=function(e){function r(M,U,V){return m?[M,V,U]:[M,U,V]}function t(M){return M+(M-M*M)/2}e=e||{};for(var n=new P(e),a=new C,o=e.detail||6,u=0;u<8;u++)for(var s=H(u),m=s.x*s.y*s.z>0,c=[],f=0;f<=o;f++){for(var l=0;f+l<=o;l++){var E=f/o,x=l/o,y=(o-f-l)/o,R={vertex:new h(t(E),t(x),t(y)).unit().multiply(s).toArray()};n.coords&&(R.coord=s.y>0?[1-E,y]:[y,1-E]),c.push(a.add(R))}if(f>0)for(var l=0;f+l<=o;l++){var E=(f-1)*(o+1)+(f-1-(f-1)*(f-1))/2+l,x=f*(o+1)+(f-f*f)/2+l;n.triangles.push(r(c[E],c[E+1],c[x])),f+l<o&&n.triangles.push(r(c[x],c[E+1],c[x+1]))}}return n.vertices=a.unique.map(function(M){return M.vertex}),n.coords&&(n.coords=a.unique.map(function(M){return M.coord})),n.normals&&(n.normals=n.vertices),n.compile(),n},P.load=function(e,r){r=r||{},"coords"in r||(r.coords=!!e.coords),"normals"in r||(r.normals=!!e.normals),"colors"in r||(r.colors=!!e.colors),"triangles"in r||(r.triangles=!!e.triangles),"lines"in r||(r.lines=!!e.lines);var t=new P(r);return t.vertices=e.vertices,t.coords&&(t.coords=e.coords),t.normals&&(t.normals=e.normals),t.colors&&(t.colors=e.colors),t.triangles&&(t.triangles=e.triangles),t.lines&&(t.lines=e.lines),t.compile(),t};function I(e,r,t){this.t=arguments.length?e:Number.MAX_VALUE,this.hit=r,this.normal=t}I.prototype={mergeWith:function(e){e.t>0&&e.t<this.t&&(this.t=e.t,this.hit=e.hit,this.normal=e.normal)}};function N(){var e=i.getParameter(i.VIEWPORT),r=i.modelviewMatrix.m,t=new h(r[0],r[4],r[8]),n=new h(r[1],r[5],r[9]),a=new h(r[2],r[6],r[10]),o=new h(r[3],r[7],r[11]);this.eye=new h(-o.dot(t),-o.dot(n),-o.dot(a));var u=e[0],s=u+e[2],m=e[1],c=m+e[3];this.ray00=i.unProject(u,m,1).subtract(this.eye),this.ray10=i.unProject(s,m,1).subtract(this.eye),this.ray01=i.unProject(u,c,1).subtract(this.eye),this.ray11=i.unProject(s,c,1).subtract(this.eye),this.viewport=e}N.prototype={getRayForPixel:function(e,r){e=(e-this.viewport[0])/this.viewport[2],r=1-(r-this.viewport[1])/this.viewport[3];var t=h.lerp(this.ray00,this.ray10,e),n=h.lerp(this.ray01,this.ray11,e);return h.lerp(t,n,r).unit()}},N.hitTestBox=function(e,r,t,n){var a=t.subtract(e).divide(r),o=n.subtract(e).divide(r),u=h.min(a,o),s=h.max(a,o),m=u.max(),c=s.min();if(m>0&&m<c){var f=1e-6,l=e.add(r.multiply(m));return t=t.add(f),n=n.subtract(f),new I(m,l,new h((l.x>n.x)-(l.x<t.x),(l.y>n.y)-(l.y<t.y),(l.z>n.z)-(l.z<t.z)))}return null},N.hitTestSphere=function(e,r,t,n){var a=e.subtract(t),o=r.dot(r),u=2*r.dot(a),s=a.dot(a)-n*n,m=u*u-4*o*s;if(m>0){var c=(-u-Math.sqrt(m))/(2*o),f=e.add(r.multiply(c));return new I(c,f,f.subtract(t).divide(n))}return null},N.hitTestTriangle=function(e,r,t,n,a){var o=n.subtract(t),u=a.subtract(t),s=o.cross(u).unit(),m=s.dot(t.subtract(e))/s.dot(r);if(m>0){var c=e.add(r.multiply(m)),f=c.subtract(t),l=u.dot(u),E=u.dot(o),x=u.dot(f),y=o.dot(o),R=o.dot(f),M=l*y-E*E,U=(y*x-E*R)/M,V=(l*R-E*x)/M;if(U>=0&&V>=0&&U+V<=1)return new I(m,c,s)}return null};function X(e,r,t){let n;for(;(n=e.exec(r))!=null;)t(n)}var O="LIGHTGL";function k(e,r){function t(l){var E=document.getElementById(l);return E?E.text:l}e=t(e),r=t(r);var n="    uniform mat3 gl_NormalMatrix;    uniform mat4 gl_ModelViewMatrix;    uniform mat4 gl_ProjectionMatrix;    uniform mat4 gl_ModelViewProjectionMatrix;    uniform mat4 gl_ModelViewMatrixInverse;    uniform mat4 gl_ProjectionMatrixInverse;    uniform mat4 gl_ModelViewProjectionMatrixInverse;  ",a=n+"    attribute vec4 gl_Vertex;    attribute vec4 gl_TexCoord;    attribute vec3 gl_Normal;    attribute vec4 gl_Color;    vec4 ftransform() {      return gl_ModelViewProjectionMatrix * gl_Vertex;    }  ",o="    precision highp float;  "+n,u=e+r,s={};X(/\b(gl_[^;]*)\b;/g,n,function(l){var E=l[1];if(u.indexOf(E)!=-1){var x=E.replace(/[a-z_]/g,"");s[x]=O+E}}),u.indexOf("ftransform")!=-1&&(s.MVPM=O+"gl_ModelViewProjectionMatrix"),this.usedMatrices=s;function m(l,E){var x={},y=/^((\s*\/\/.*\n|\s*#extension.*\n)+)[^]*$/.exec(E);return E=y?y[1]+l+E.substr(y[1].length):l+E,X(/\bgl_\w+\b/g,l,function(R){R in x||(E=E.replace(new RegExp("\\b"+R+"\\b","g"),O+R),x[R]=!0)}),E}e=m(a,e),r=m(o,r);function c(l,E){var x=i.createShader(l);if(i.shaderSource(x,E),i.compileShader(x),!i.getShaderParameter(x,i.COMPILE_STATUS))throw new Error("compile error: "+i.getShaderInfoLog(x));return x}if(this.program=i.createProgram(),i.attachShader(this.program,c(i.VERTEX_SHADER,e)),i.attachShader(this.program,c(i.FRAGMENT_SHADER,r)),i.linkProgram(this.program),!i.getProgramParameter(this.program,i.LINK_STATUS))throw new Error("link error: "+i.getProgramInfoLog(this.program));this.attributes={},this.uniformLocations={};var f={};X(/uniform\s+sampler(1D|2D|3D|Cube)\s+(\w+)\s*;/g,e+r,function(l){f[l[2]]=1}),this.isSampler=f}function $(e){var r=Object.prototype.toString.call(e);return r=="[object Array]"||r=="[object Float32Array]"}function j(e){var r=Object.prototype.toString.call(e);return r=="[object Number]"||r=="[object Boolean]"}new v,new v,k.prototype={uniforms:function(e){i.useProgram(this.program);for(var r in e){var t=this.uniformLocations[r]||i.getUniformLocation(this.program,r);if(t){this.uniformLocations[r]=t;var n=e[r];if(n instanceof h?n=[n.x,n.y,n.z]:n instanceof v&&(n=n.m),$(n))switch(n.length){case 1:i.uniform1fv(t,new Float32Array(n));break;case 2:i.uniform2fv(t,new Float32Array(n));break;case 3:i.uniform3fv(t,new Float32Array(n));break;case 4:i.uniform4fv(t,new Float32Array(n));break;case 9:i.uniformMatrix3fv(t,!1,new Float32Array([n[0],n[3],n[6],n[1],n[4],n[7],n[2],n[5],n[8]]));break;case 16:i.uniformMatrix4fv(t,!1,new Float32Array([n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]]));break;default:throw new Error(`don't know how to load uniform "`+r+'" of length '+n.length)}else if(j(n))(this.isSampler[r]?i.uniform1i:i.uniform1f).call(i,t,n);else throw new Error('attempted to set uniform "'+r+'" to invalid value '+n)}}return this},draw:function(e,r){this.drawBuffers(e.vertexBuffers,e.indexBuffers[r==i.LINES?"lines":"triangles"],arguments.length<2?i.TRIANGLES:r)},drawBuffers:function(e,r,t){var n=this.usedMatrices,a=i.modelviewMatrix,o=i.projectionMatrix,u=n.MVMI||n.NM?a.inverse():null,s=n.PMI?o.inverse():null,m=n.MVPM||n.MVPMI?o.multiply(a):null,c={};if(n.MVM&&(c[n.MVM]=a),n.MVMI&&(c[n.MVMI]=u),n.PM&&(c[n.PM]=o),n.PMI&&(c[n.PMI]=s),n.MVPM&&(c[n.MVPM]=m),n.MVPMI&&(c[n.MVPMI]=m.inverse()),n.NM){var f=u.m;c[n.NM]=[f[0],f[4],f[8],f[1],f[5],f[9],f[2],f[6],f[10]]}this.uniforms(c);var l=0;for(var E in e){var x=e[E],y=this.attributes[E]||i.getAttribLocation(this.program,E.replace(/^(gl_.*)$/,O+"$1"));y==-1||!x.buffer||(this.attributes[E]=y,i.bindBuffer(i.ARRAY_BUFFER,x.buffer),i.enableVertexAttribArray(y),i.vertexAttribPointer(y,x.buffer.spacing,i.FLOAT,!1,0,0),l=x.buffer.length/x.buffer.spacing)}for(var E in this.attributes)E in e||i.disableVertexAttribArray(this.attributes[E]);return l&&(!r||r.buffer)&&(r?(i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r.buffer),i.drawElements(t,r.buffer.length,i.UNSIGNED_SHORT,0)):i.drawArrays(t,0,l)),this}};function _(e,r,t){t=t||{},this.id=i.createTexture(),this.width=e,this.height=r,this.format=t.format||i.RGBA,this.type=t.type||i.UNSIGNED_BYTE;var n=t.filter||t.magFilter||i.LINEAR,a=t.filter||t.minFilter||i.LINEAR;if(this.type===i.FLOAT){if(!_.canUseFloatingPointTextures())throw new Error("OES_texture_float is required but not supported");if((a!==i.NEAREST||n!==i.NEAREST)&&!_.canUseFloatingPointLinearFiltering())throw new Error("OES_texture_float_linear is required but not supported")}else if(this.type===i.HALF_FLOAT_OES){if(!_.canUseHalfFloatingPointTextures())throw new Error("OES_texture_half_float is required but not supported");if((a!==i.NEAREST||n!==i.NEAREST)&&!_.canUseHalfFloatingPointLinearFiltering())throw new Error("OES_texture_half_float_linear is required but not supported")}i.bindTexture(i.TEXTURE_2D,this.id),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t.wrap||t.wrapS||i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t.wrap||t.wrapT||i.CLAMP_TO_EDGE),i.texImage2D(i.TEXTURE_2D,0,this.format,e,r,0,this.format,this.type,null)}var z,L,G;_.prototype={bind:function(e){i.activeTexture(i.TEXTURE0+(e||0)),i.bindTexture(i.TEXTURE_2D,this.id)},unbind:function(e){i.activeTexture(i.TEXTURE0+(e||0)),i.bindTexture(i.TEXTURE_2D,null)},canDrawTo:function(){z=z||i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,z),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.id,0);var e=i.checkFramebufferStatus(i.FRAMEBUFFER)==i.FRAMEBUFFER_COMPLETE;return i.bindFramebuffer(i.FRAMEBUFFER,null),e},drawTo:function(e){var r=i.getParameter(i.VIEWPORT);if(z=z||i.createFramebuffer(),L=L||i.createRenderbuffer(),i.bindFramebuffer(i.FRAMEBUFFER,z),i.bindRenderbuffer(i.RENDERBUFFER,L),(this.width!=L.width||this.height!=L.height)&&(L.width=this.width,L.height=this.height,i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,this.width,this.height)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.id,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,L),i.checkFramebufferStatus(i.FRAMEBUFFER)!=i.FRAMEBUFFER_COMPLETE)throw new Error("Rendering to this texture is not supported (incomplete framebuffer)");i.viewport(0,0,this.width,this.height),e(),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindRenderbuffer(i.RENDERBUFFER,null),i.viewport(r[0],r[1],r[2],r[3])},swapWith:function(e){var r;r=e.id,e.id=this.id,this.id=r,r=e.width,e.width=this.width,this.width=r,r=e.height,e.height=this.height,this.height=r}},_.fromImage=function(e,r){r=r||{};var t=new _(e.width,e.height,r);try{i.texImage2D(i.TEXTURE_2D,0,t.format,t.format,t.type,e)}catch{throw location.protocol=="file:"?new Error('image not loaded for security reasons (serve this page over "http://" instead)'):new Error("image not loaded for security reasons (image must originate from the same domain as this page or use Cross-Origin Resource Sharing)")}return r.minFilter&&r.minFilter!=i.NEAREST&&r.minFilter!=i.LINEAR&&i.generateMipmap(i.TEXTURE_2D),t},_.fromURL=function(e,r){G=G||function(){var o=document.createElement("canvas").getContext("2d");o.canvas.width=o.canvas.height=128;for(var u=0;u<o.canvas.height;u+=16)for(var s=0;s<o.canvas.width;s+=16)o.fillStyle=(s^u)&16?"#FFF":"#DDD",o.fillRect(s,u,16,16);return o.canvas}();var t=_.fromImage(G,r),n=new Image,a=i;return n.onload=function(){a.makeCurrent(),_.fromImage(n,r).swapWith(t)},n.src=e,t},_.canUseFloatingPointTextures=function(){return!!i.getExtension("OES_texture_float")},_.canUseFloatingPointLinearFiltering=function(){return!!i.getExtension("OES_texture_float_linear")},_.canUseHalfFloatingPointTextures=function(){return!!i.getExtension("OES_texture_half_float")},_.canUseHalfFloatingPointLinearFiltering=function(){return!!i.getExtension("OES_texture_half_float_linear")};function h(e,r,t){this.x=e||0,this.y=r||0,this.z=t||0}return h.prototype={negative:function(){return new h(-this.x,-this.y,-this.z)},add:function(e){return e instanceof h?new h(this.x+e.x,this.y+e.y,this.z+e.z):new h(this.x+e,this.y+e,this.z+e)},subtract:function(e){return e instanceof h?new h(this.x-e.x,this.y-e.y,this.z-e.z):new h(this.x-e,this.y-e,this.z-e)},multiply:function(e){return e instanceof h?new h(this.x*e.x,this.y*e.y,this.z*e.z):new h(this.x*e,this.y*e,this.z*e)},divide:function(e){return e instanceof h?new h(this.x/e.x,this.y/e.y,this.z/e.z):new h(this.x/e,this.y/e,this.z/e)},equals:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},cross:function(e){return new h(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.divide(this.length())},min:function(){return Math.min(Math.min(this.x,this.y),this.z)},max:function(){return Math.max(Math.max(this.x,this.y),this.z)},toAngles:function(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}},angleTo:function(e){return Math.acos(this.dot(e)/(this.length()*e.length()))},toArray:function(e){return[this.x,this.y,this.z].slice(0,e||3)},clone:function(){return new h(this.x,this.y,this.z)},init:function(e,r,t){return this.x=e,this.y=r,this.z=t,this}},h.negative=function(e,r){return r.x=-e.x,r.y=-e.y,r.z=-e.z,r},h.add=function(e,r,t){return r instanceof h?(t.x=e.x+r.x,t.y=e.y+r.y,t.z=e.z+r.z):(t.x=e.x+r,t.y=e.y+r,t.z=e.z+r),t},h.subtract=function(e,r,t){return r instanceof h?(t.x=e.x-r.x,t.y=e.y-r.y,t.z=e.z-r.z):(t.x=e.x-r,t.y=e.y-r,t.z=e.z-r),t},h.multiply=function(e,r,t){return r instanceof h?(t.x=e.x*r.x,t.y=e.y*r.y,t.z=e.z*r.z):(t.x=e.x*r,t.y=e.y*r,t.z=e.z*r),t},h.divide=function(e,r,t){return r instanceof h?(t.x=e.x/r.x,t.y=e.y/r.y,t.z=e.z/r.z):(t.x=e.x/r,t.y=e.y/r,t.z=e.z/r),t},h.cross=function(e,r,t){return t.x=e.y*r.z-e.z*r.y,t.y=e.z*r.x-e.x*r.z,t.z=e.x*r.y-e.y*r.x,t},h.unit=function(e,r){var t=e.length();return r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r},h.fromAngles=function(e,r){return new h(Math.cos(e)*Math.cos(r),Math.sin(r),Math.sin(e)*Math.cos(r))},h.randomDirection=function(){return h.fromAngles(Math.random()*Math.PI*2,Math.asin(Math.random()*2-1))},h.min=function(e,r){return new h(Math.min(e.x,r.x),Math.min(e.y,r.y),Math.min(e.z,r.z))},h.max=function(e,r){return new h(Math.max(e.x,r.x),Math.max(e.y,r.y),Math.max(e.z,r.z))},h.lerp=function(e,r,t){return r.subtract(e).multiply(t).add(e)},h.fromArray=function(e){return new h(e[0],e[1],e[2])},h.angleBetween=function(e,r){return e.angleTo(r)},g}();let W=0;class st{constructor(g,d){if(this.gl=d,this.copyVideo=!1,this.deltaTime=0,d===null){alert("Unable to initialize WebGL. Your browser or machine may not support it.");return}d.clearColor(0,0,0,1),d.clear(d.COLOR_BUFFER_BIT);const p=this.initShaderProgram(`
  attribute vec4 aVertexPosition;
  attribute vec3 aVertexNormal;
  attribute vec2 aTextureCoord;

  uniform mat4 uNormalMatrix;
  uniform mat4 uModelViewMatrix;
  uniform mat4 uProjectionMatrix;

  varying highp vec2 vTextureCoord;
  varying highp vec3 vLighting;

  void main(void) {
    gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
    vTextureCoord = aTextureCoord;

    // Apply lighting effect

    highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);
    highp vec3 directionalLightColor = vec3(1, 1, 1);
    highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));

    highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);

    highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);
    vLighting = ambientLight + (directionalLightColor * directional);
  }
`,`
  varying highp vec2 vTextureCoord;
  varying highp vec3 vLighting;

  uniform sampler2D uSampler;

  void main(void) {
    highp vec4 texelColor = texture2D(uSampler, vTextureCoord);

    gl_FragColor = vec4(texelColor.rgb * vLighting, texelColor.a);
  }
`);this.programInfo={program:p,attribLocations:{vertexPosition:d.getAttribLocation(p,"aVertexPosition"),vertexNormal:d.getAttribLocation(p,"aVertexNormal"),textureCoord:d.getAttribLocation(p,"aTextureCoord")},uniformLocations:{projectionMatrix:d.getUniformLocation(p,"uProjectionMatrix"),modelViewMatrix:d.getUniformLocation(p,"uModelViewMatrix"),normalMatrix:d.getUniformLocation(p,"uNormalMatrix"),uSampler:d.getUniformLocation(p,"uSampler")}},this.buffers=J(d),this.texture=this.initTexture(),this.video=this.setupVideo(g),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0),this.then=0}render(g){g*=.001,this.deltaTime=g-this.then,this.then=g,this.copyVideo&&this.updateTexture(),rt(this.gl,this.programInfo,this.buffers,this.texture,W),W+=this.deltaTime}initShaderProgram(g,d){const w=this.loadShader(this.gl.VERTEX_SHADER,g),A=this.loadShader(this.gl.FRAGMENT_SHADER,d),p=this.gl.createProgram();return this.gl.attachShader(p,w),this.gl.attachShader(p,A),this.gl.linkProgram(p),this.gl.getProgramParameter(p,this.gl.LINK_STATUS)?p:(alert(`Unable to initialize the shader program: ${this.gl.getProgramInfoLog(p)}`),null)}loadShader(g,d){const w=this.gl.createShader(g);return this.gl.shaderSource(w,d),this.gl.compileShader(w),this.gl.getShaderParameter(w,this.gl.COMPILE_STATUS)?w:(alert(`An error occurred compiling the shaders: ${this.gl.getShaderInfoLog(w)}`),this.gl.deleteShader(w),null)}initTexture(){const g=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,g);const d=0,w=this.gl.RGBA,A=1,p=1,T=0,F=this.gl.RGBA,D=this.gl.UNSIGNED_BYTE,B=new Uint8Array([0,0,255,255]);return this.gl.texImage2D(this.gl.TEXTURE_2D,d,w,A,p,T,F,D,B),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),g}updateTexture(){const d=this.gl.RGBA,w=this.gl.RGBA,A=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,d,w,A,this.video)}setupVideo(g){const d=document.createElement("video");let w=!1,A=!1;d.playsInline=!0,d.muted=!0,d.loop=!0,d.addEventListener("playing",()=>{w=!0,T()},!0),d.addEventListener("timeupdate",()=>{A=!0,T()},!0),d.src=g,d.play();const p=this,T=()=>{w&&A&&(p.copyVideo=!0)};return d}}const q=ot.create();document.body.appendChild(q.canvas);const ut=new st("./assets/video.mp4",q),K=function(i){ut.render(i),requestAnimationFrame(K)};requestAnimationFrame(K);
//# sourceMappingURL=swimming-BxPpeWpP.js.map
